"use strict";(self.webpackChunkrps=self.webpackChunkrps||[]).push([[550],{15550:function(r,e,n){n.r(e),n.d(e,{PhantomInjectedProvider:function(){return _},SlopeInjectedProxyProvider:function(){return z},SolanaPrivateKeyProvider:function(){return G},SolanaWallet:function(){return J},SolflareInjectedProvider:function(){return D},SolletInjectedProvider:function(){return U},TorusInjectedProvider:function(){return R}});var t=n(37762),a=n(15671),s=n(43144),i=n(60136),u=n(29388),c=n(74165),o=n(15861),p=n(4942),f=n(2609),h=n(23484),d=n(45781),v=n(21480),l=n(79955),g=n.n(l),m=n(98689),w=n(19548),Z=n(80889),y=n.n(Z),x=n(40918).Buffer;function b(r){return function(e,n,t,a){return"solana_chainId"===e.method?(n.result=r,a()):t()}}function k(r){return function(e,n,t,a){return"solana_provider_config"===e.method?(n.result=r,a()):t()}}function P(r){var e=r.chainId;return(0,h.UZ)([b(e),k(r)])}function E(r){var e=r.rpcTarget,n=(0,f.v$)({rpcTarget:e});return{networkMiddleware:(0,h.UZ)([P(r),n]),fetchMiddleware:n}}function O(r){var e=r.getAccounts;return(0,h.Pk)(function(){var r=(0,o.Z)((0,c.Z)().mark((function r(n,t,a){var s;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("getAccounts"===n.method){r.next=3;break}return r.abrupt("return",a());case 3:if(e){r.next=5;break}throw new Error("WalletMiddleware - opts.getAccounts not provided");case 5:return r.next=7,e(n);case 7:return s=r.sent,t.result=s,r.abrupt("return",void 0);case 10:case"end":return r.stop()}}),r)})));return function(e,n,t){return r.apply(this,arguments)}}())}function A(r){var e=r.requestAccounts;return(0,h.Pk)(function(){var r=(0,o.Z)((0,c.Z)().mark((function r(n,t,a){var s;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("requestAccounts"===n.method){r.next=3;break}return r.abrupt("return",a());case 3:if(e){r.next=5;break}throw new Error("WalletMiddleware - opts.requestAccounts not provided");case 5:return r.next=7,e(n);case 7:return s=r.sent,t.result=s,r.abrupt("return",void 0);case 10:case"end":return r.stop()}}),r)})));return function(e,n,t){return r.apply(this,arguments)}}())}function j(r,e){return(0,h.Pk)(function(){var n=(0,o.Z)((0,c.Z)().mark((function n(t,a,s){var i;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.method===r){n.next=3;break}return n.abrupt("return",s());case 3:if(e){n.next=5;break}throw new Error("WalletMiddleware - ".concat(r," not provided"));case 5:return n.next=7,e(t);case 7:return i=n.sent,a.result=i,n.abrupt("return",void 0);case 10:case"end":return n.stop()}}),n)})));return function(r,e,t){return n.apply(this,arguments)}}())}function S(r){var e=r.getAccounts,n=r.requestAccounts,t=r.signTransaction,a=r.signAndSendTransaction,s=r.signAllTransactions,i=r.signMessage,u=r.getPrivateKey,c=r.getSecretKey;return(0,h.UZ)([A({requestAccounts:n}),O({getAccounts:e}),j("signTransaction",t),j("signAndSendTransaction",a),j("signAllTransactions",s),j("signMessage",i),j("solanaPrivateKey",u),j("solanaSecretKey",c)])}function T(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function I(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){(0,p.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var C=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(r){(0,a.Z)(this,n);var t=r.config,s=r.state;return e.call(this,{config:{chainConfig:I(I({},t.chainConfig),{},{chainNamespace:d.EN.SOLANA})},state:s})}return(0,s.Z)(n,[{key:"switchChain",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve());case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},{key:"setupProvider",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t,a,s,i,u;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new h.eI,t=this.getProviderHandlers(e),a=S(t),n.push(a),s=P(this.config.chainConfig),n.push(s),(i=this.getInjectedProviderProxy(e))&&n.push(i),u=(0,f.Xj)(n),this.updateProviderEngineProxy(u),r.next=12,this.lookupNetwork();case 12:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"lookupNetwork",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){var e;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.config.chainConfig,this.update({chainId:e.chainId}),r.abrupt("return",e.chainId||"");case 3:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"getInjectedProviderProxy",value:function(r){}}]),n}(v.Zk),K=function(r){var e={requestAccounts:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.publicKey?[g().encode(r.publicKey.toBytes())]:[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getAccounts:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.publicKey?[g().encode(r.publicKey.toBytes())]:[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getPrivateKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw m.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getSecretKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw m.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),signTransaction:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.signTransaction(n.params.message);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signMessage:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.signMessage(n.params.message,n.params.display);case 2:return t=e.sent,e.abrupt("return",t.signature);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAllTransactions:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.params)&&void 0!==t&&t.message&&null!==(a=n.params)&&void 0!==a&&a.message.length){e.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return e.next=4,r.signAllTransactions(n.params.message);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAndSendTransaction:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.signAndSendTransaction(n.params.message);case 2:return t=e.sent,e.abrupt("return",{signature:t.signature});case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return e};function q(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function M(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){(0,p.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}function N(r){return(0,h.Pk)(function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n,t,a){var s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.request(M({},n));case 2:s=e.sent,t.result=s;case 4:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}())}var _=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(){return(0,a.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"getProviderHandlers",value:function(r){return K(r)}},{key:"getInjectedProviderProxy",value:function(r){return N(r)}}]),n}(C),z=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(){return(0,a.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"getProviderHandlers",value:function(r){return function(r,e){var n={requestAccounts:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var n,t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.connect();case 2:return n=e.sent,t=n.data,e.abrupt("return",[t.publicKey]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getAccounts:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var n,t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.connect();case 2:return n=e.sent,t=n.data,e.abrupt("return",[t.publicKey]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getPrivateKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw m.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getSecretKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw m.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),signTransaction:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s,i,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.params.message){e.next=3;break}throw m.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 3:return e.next=5,r.signTransaction(g().encode(t.serializeMessage()));case 5:if(a=e.sent,(s=a.data).publicKey&&s.signature){e.next=9;break}throw new Error("Invalid signature from slope wallet");case 9:return i=new w.PublicKey(s.publicKey),u=g().decode(s.signature),t.addSignature(i,u),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signMessage:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.signMessage(n.params.message);case 2:return t=e.sent,e.abrupt("return",g().decode(t.data.signature));case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAndSendTransaction:function(){var n=(0,o.Z)((0,c.Z)().mark((function n(t){var a,s,i,u,o,p,f,h,d;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e()){n.next=3;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:if(s=t.params.message){n.next=6;break}throw m.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 6:return n.next=8,r.signTransaction(g().encode(s.serializeMessage()));case 8:if(i=n.sent,(u=i.data).publicKey&&u.signature){n.next=12;break}throw new Error("Invalid signature from slope wallet");case 12:return o=new w.PublicKey(u.publicKey),p=g().decode(u.signature),s.addSignature(o,p),n.next=17,a.request({method:"solana_provider_config",params:[]});case 17:return f=n.sent,h=new w.Connection(f.rpcTarget),n.next=21,h.sendRawTransaction(s.serialize());case 21:return d=n.sent,n.abrupt("return",{signature:d});case 23:case"end":return n.stop()}}),n)})));return function(r){return n.apply(this,arguments)}}(),signAllTransactions:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s,i,u,o,p,f,h,d,v,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.params)&&void 0!==t&&t.message&&null!==(a=n.params)&&void 0!==a&&a.message.length){e.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:for(i=n.params.message,u=i.length,o=[],p=0;p<u;p++)o.push(g().encode(n.params.message[p].serializeMessage()));return e.next=8,r.signAllTransactions(o);case 8:if(f=e.sent,h=f.msg,(d=f.data).publicKey&&(null===(s=d.signatures)||void 0===s?void 0:s.length)===u){e.next=13;break}throw new Error(h);case 13:for(v=new w.PublicKey(d.publicKey),p=0;p<u;p++)l=g().decode(d.signatures[p]),i[p].addSignature(v,l);return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return n}(r,this.getProviderEngineProxy.bind(this))}}]),n}(C),D=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(){return(0,a.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"getProviderHandlers",value:function(r){return function(r,e){var n=K(r);return n.signAndSendTransaction=function(){var n=(0,o.Z)((0,c.Z)().mark((function n(t){var a,s,i,u,o;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e()){n.next=3;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return n.next=5,r.signTransaction(t.params.message);case 5:return s=n.sent,n.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return i=n.sent,u=new w.Connection(i.rpcTarget),n.next=12,u.sendRawTransaction(s.serialize());case 12:return o=n.sent,n.abrupt("return",{signature:o});case 14:case"end":return n.stop()}}),n)})));return function(r){return n.apply(this,arguments)}}(),n}(r,this.getProviderEngineProxy.bind(this))}}]),n}(C),U=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(){return(0,a.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"getProviderHandlers",value:function(r){return function(r,e){var n=K(r);return n.signMessage=function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.sign(n.params.message,"utf8");case 2:return t=e.sent,a=t.signature,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),n.signAndSendTransaction=function(){var n=(0,o.Z)((0,c.Z)().mark((function n(t){var a,s,i,u,o;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e()){n.next=3;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return n.next=5,r.signTransaction(t.params.message);case 5:return s=n.sent,n.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return i=n.sent,u=new w.Connection(i.rpcTarget),n.next=12,u.sendRawTransaction(s.serialize());case 12:return o=n.sent,n.abrupt("return",{signature:o});case 14:case"end":return n.stop()}}),n)})));return function(r){return n.apply(this,arguments)}}(),n}(r,this.getProviderEngineProxy.bind(this))}}]),n}(C),H=function(r){var e={requestAccounts:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.request({method:"solana_requestAccounts",params:{}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getAccounts:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.request({method:"solana_requestAccounts",params:{}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getPrivateKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw m.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getSecretKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw m.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),signMessage:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.params)&&void 0!==t&&t.message){e.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return e.next=4,r.signMessage(n.params.message);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signTransaction:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.params)&&void 0!==t&&t.message){e.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return a=n.params.message,e.next=5,r.signTransaction(a);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAndSendTransaction:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.params)&&void 0!==t&&t.message){e.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return a=n.params.message,e.next=5,r.sendTransaction(a);case 5:return s=e.sent,e.abrupt("return",{signature:s});case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAllTransactions:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.params)&&void 0!==t&&t.message&&null!==(a=n.params)&&void 0!==a&&a.message.length){e.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return s=n.params.message,e.next=5,r.signAllTransactions(s);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return e};function B(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function L(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){(0,p.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var R=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(r){(0,a.Z)(this,n);var t=r.config,s=r.state;return e.call(this,{config:{chainConfig:L(L({},t.chainConfig),{},{chainNamespace:d.EN.SOLANA})},state:s})}return(0,s.Z)(n,[{key:"switchChain",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve());case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},{key:"setupProvider",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.handleInjectedProviderUpdate(e),r.next=3,this.setupEngine(e);case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"lookupNetwork",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){var e,n,t;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.provider){r.next=2;break}throw m.ethErrors.provider.custom({message:"Torus solana provider is not initialized",code:4902});case 2:return e=this.config.chainConfig.chainId,r.next=5,this.provider.request({method:"solana_chainId"});case 5:if(n=r.sent,t=(0,d.H2)(n.toString())?n:"0x".concat(parseInt(n,10).toString(16)),e===t){r.next=9;break}throw d.Ty.rpcConnectionError("Invalid network, net_version is: ".concat(t,", expected: ").concat(e));case 9:return this.update({chainId:t}),this.provider.emit("connect",{chainId:this.state.chainId}),this.provider.emit("chainChanged",this.state.chainId),r.abrupt("return",this.state.chainId);case 13:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"setupEngine",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t,a,s,i;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=H(e),t=S(n),a=N(e),(s=new h.eI).push(t),s.push(a),i=(0,f.Xj)(s),this.updateProviderEngineProxy(i),r.next=10,this.lookupNetwork();case 10:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"handleInjectedProviderUpdate",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n=this;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.on("accountsChanged",function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n.provider.emit("accountsChanged",e);case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),e.on("chainChanged",function(){var r=(0,o.Z)((0,c.Z)().mark((function r(t){var a;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=(0,d.H2)(t)?t:"0x".concat(parseInt(t,10).toString(16)),n.configure({chainConfig:L(L({},n.config.chainConfig),{},{chainId:a})}),r.next=4,n.setupProvider(e);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}]),n}(v.Zk);function W(r){return X.apply(this,arguments)}function X(){return X=(0,o.Z)((0,c.Z)().mark((function r(e){var n,a,s,i,u;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.privKey,a=e.getProviderEngineProxy,s=function(){return w.Keypair.fromSecretKey(x.from(n,"hex"))},"string"===typeof n){r.next=4;break}throw d.Ty.invalidParams("privKey must be a string");case 4:return i=s(),u={requestAccounts:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getAccounts:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getPrivateKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getSecretKey:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",g().encode(i.secretKey));case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),signTransaction:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(n=e.params)&&void 0!==n&&n.message){r.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return(t=e.params.message).partialSign(i),r.abrupt("return",t);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),signMessage:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(n=e.params)&&void 0!==n&&n.message){r.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:return t=y().sign.detached(e.params.message,i.secretKey),r.abrupt("return",t);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),signAndSendTransaction:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t,s,u;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(n=e.params)&&void 0!==n&&n.message){r.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:if(t=a()){r.next=5;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return(s=e.params.message).sign(i),r.next=9,t.request({method:"sendTransaction",params:[g().encode(s.serialize())]});case 9:return u=r.sent,r.abrupt("return",{signature:u});case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),signAllTransactions:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,a,s,u,o,p,f;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(n=e.params)&&void 0!==n&&n.message&&null!==(a=e.params)&&void 0!==a&&a.message.length){r.next=2;break}throw m.ethErrors.rpc.invalidParams("message");case 2:u=null===(s=e.params)||void 0===s?void 0:s.message,o=(0,t.Z)(u||[]);try{for(o.s();!(p=o.n()).done;)f=p.value,f.partialSign(i)}catch(c){o.e(c)}finally{o.f()}return r.abrupt("return",u);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},r.abrupt("return",u);case 7:case"end":return r.stop()}}),r)}))),X.apply(this,arguments)}function F(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function $(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){(0,p.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var G=function(r){(0,i.Z)(n,r);var e=(0,u.Z)(n);function n(r){(0,a.Z)(this,n);var t=r.config,s=r.state;return e.call(this,{config:{chainConfig:$($({},t.chainConfig),{},{chainNamespace:d.EN.SOLANA})},state:s})}return(0,s.Z)(n,[{key:"enable",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.state.privateKey){r.next=2;break}throw m.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return r.next=4,this.setupProvider(this.state.privateKey);case 4:return r.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"setupProvider",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t,a,s,i,u;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,W({privKey:e,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)});case 2:return n=r.sent,t=S(n),a=new h.eI,s=E(this.config.chainConfig),i=s.networkMiddleware,a.push(this.getChainSwitchMiddleware()),a.push(this.getAccountMiddleware()),a.push(t),a.push(i),u=(0,f.Xj)(a),this.updateProviderEngineProxy(u),r.next=14,this.lookupNetwork();case 14:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"updateAccount",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._providerEngineProxy){r.next=2;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return r.next=4,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 4:if(r.sent===e.privateKey){r.next=14;break}return r.next=8,this.setupProvider(e.privateKey);case 8:return r.t0=this._providerEngineProxy,r.next=11,this._providerEngineProxy.request({method:"requestAccounts"});case 11:r.t1=r.sent,r.t2={accounts:r.t1},r.t0.emit.call(r.t0,"accountsChanged",r.t2);case 14:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"switchChain",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._providerEngineProxy){r.next=2;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return n=this.getChainConfig(e.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:n}),r.next=7,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 7:return t=r.sent,r.next=10,this.setupProvider(t);case 10:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"lookupNetwork",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){var e,n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._providerEngineProxy){r.next=2;break}throw m.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return r.next=4,this._providerEngineProxy.request({method:"getHealth",params:[]});case 4:if(e=r.sent,n=this.config.chainConfig,"ok"===e){r.next=8;break}throw d.Ty.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(n.rpcTarget));case 8:return this.update({chainId:n.chainId}),this.state.chainId!==n.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),r.abrupt("return",this.state.chainId);case 11:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"getChainSwitchMiddleware",value:function(){var r=this,e={addNewChainConfig:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t,a,s,i,u,o;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.params){e.next=2;break}throw m.ethErrors.rpc.invalidParams("Missing request params");case 2:if(t=n.params,a=t.chainId,s=t.chainName,i=t.rpcUrls,u=t.blockExplorerUrls,o=t.nativeCurrency,a){e.next=5;break}throw m.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(i&&0!==i.length){e.next=7;break}throw m.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(o){e.next=9;break}throw m.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:r.addChain({chainNamespace:d.EN.SOLANA,chainId:a,ticker:(null===o||void 0===o?void 0:o.symbol)||"SOL",tickerName:(null===o||void 0===o?void 0:o.name)||"Solana",displayName:s,rpcTarget:i[0],blockExplorer:(null===u||void 0===u?void 0:u[0])||""});case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),switchSolanaChain:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.params){e.next=2;break}throw m.ethErrors.rpc.invalidParams("Missing request params");case 2:if(n.params.chainId){e.next=4;break}throw m.ethErrors.rpc.invalidParams("Missing chainId");case 4:return e.next=6,r.switchChain(n.params);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return function(r){var e=r.addNewChainConfig,n=r.switchSolanaChain;return(0,h.UZ)([j("addSolanaChain",e),j("switchSolanaChain",n)])}(e)}},{key:"getAccountMiddleware",value:function(){var r=this,e={updatePrivatekey:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(n){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.params){e.next=2;break}throw m.ethErrors.rpc.invalidParams("Missing request params");case 2:if(n.params.privateKey){e.next=4;break}throw m.ethErrors.rpc.invalidParams("Missing privateKey");case 4:return t=n.params.privateKey,e.next=7,r.updateAccount({privateKey:t});case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return function(r){var e=r.updatePrivatekey;return(0,h.UZ)([j("updateAccount",e)])}(e)}}]),n}(v.Zk);(0,p.Z)(G,"getProviderInstance",function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new G({config:{chainConfig:e.chainConfig}}),r.next=3,n.setupProvider(e.privKey);case 3:return r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());var J=function(){function r(e){(0,a.Z)(this,r),(0,p.Z)(this,"provider",void 0),this.provider=e}return(0,s.Z)(r,[{key:"requestAccounts",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(){var e;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.provider.request({method:"requestAccounts",params:{}});case 2:return e=r.sent,r.abrupt("return",e);case 4:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"signAndSendTransaction",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n,t;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.provider.request({method:"signAndSendTransaction",params:{message:e}});case 2:return n=r.sent,t=n.signature,r.abrupt("return",{signature:t});case 5:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.provider.request({method:"signTransaction",params:{message:e}});case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.provider.request({method:"signAllTransactions",params:{message:e}});case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"signMessage",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.provider.request({method:"signMessage",params:{message:e}});case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"request",value:function(){var r=(0,o.Z)((0,c.Z)().mark((function r(e){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.provider.request(e);case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()}]),r}()}}]);