"use strict";(self.webpackChunkrps=self.webpackChunkrps||[]).push([[961],{26961:function(t,e,n){n.r(e),n.d(e,{SolanaWalletAdapter:function(){return Z}});var r=n(74165),i=n(15861),s=n(15671),a=n(43144),o=n(97326),c=n(11752),u=n(61120),h=n(60136),l=n(29388),p=n(4942),d=n(6757),f=n(45781),g=n(99547),v=n(15550);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){(0,p.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Z=function(t){(0,h.Z)(n,t);var e=(0,l.Z)(n);function n(){var t;(0,s.Z)(this,n);var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=e.call(this),(0,p.Z)((0,o.Z)(t),"name",f.rW.TORUS_SOLANA),(0,p.Z)((0,o.Z)(t),"adapterNamespace",f.yk.SOLANA),(0,p.Z)((0,o.Z)(t),"currentChainNamespace",f.EN.SOLANA),(0,p.Z)((0,o.Z)(t),"type",f.hN.EXTERNAL),(0,p.Z)((0,o.Z)(t),"status",f.MP.NOT_READY),(0,p.Z)((0,o.Z)(t),"torusInstance",null),(0,p.Z)((0,o.Z)(t),"torusWalletOptions",void 0),(0,p.Z)((0,o.Z)(t),"initParams",void 0),(0,p.Z)((0,o.Z)(t),"loginSettings",{}),(0,p.Z)((0,o.Z)(t),"solanaProvider",null),(0,p.Z)((0,o.Z)(t),"rehydrated",!1),t.torusWalletOptions=r.adapterSettings||{},t.initParams=r.initParams||{},t.loginSettings=r.loginSettings||{},t.chainConfig=r.chainConfig||null,t.sessionTime=r.sessionTime||86400,t}return(0,a.Z)(n,[{key:"provider",get:function(){var t;return this.status===f.MP.CONNECTED&&this.solanaProvider&&(null===(t=this.solanaProvider)||void 0===t?void 0:t.provider)||null},set:function(t){throw new Error("Not implemented")}},{key:"init",value:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(e){var i,s,a,o,h,l,p,g,k,Z,y,O,T,m,b;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,c.Z)((0,u.Z)(n.prototype),"checkInitializationRequirements",this).call(this),this.chainConfig?(k=this.chainConfig,Z=k.chainId,y=k.blockExplorer,O=k.displayName,T=k.rpcTarget,m=k.ticker,b=k.tickerName,i={chainId:Z,rpcTarget:T,blockExplorerUrl:y,displayName:O,tickerName:b,ticker:m,logo:""}):(this.chainConfig=(0,f.h2)(f.EN.SOLANA,"0x1"),s=this.chainConfig,a=s.blockExplorer,o=s.displayName,h=s.ticker,l=s.tickerName,p=s.rpcTarget,g=s.chainId,i={chainId:g,rpcTarget:p,blockExplorerUrl:a,displayName:o,ticker:h,tickerName:l,logo:""}),this.torusInstance=new d.default(this.torusWalletOptions),f.cM.debug("initializing torus solana adapter init"),t.next=6,this.torusInstance.init(N(N({showTorusButton:!1},this.initParams),{},{network:i}));case 6:if(this.solanaProvider=new v.TorusInjectedProvider({config:{chainConfig:this.chainConfig}}),this.status=f.MP.READY,this.emit(f.n2.READY,f.rW.TORUS_SOLANA),t.prev=9,f.cM.debug("initializing torus solana adapter"),!e.autoConnect){t.next=15;break}return this.rehydrated=!0,t.next=15,this.connect();case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),f.cM.error("Failed to connect with cached torus solana provider",t.t0),this.emit(f.n2.ERRORED,t.t0);case 21:case"end":return t.stop()}}),t,this,[[9,17]])})));return function(e){return t.apply(this,arguments)}}()},{key:"connect",value:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(){var e,i,s,a,o,h,l,p,d;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,c.Z)((0,u.Z)(n.prototype),"checkConnectionRequirements",this).call(this),this.torusInstance){t.next=3;break}throw f.Ty.notReady("Torus wallet is not initialized");case 3:if(this.solanaProvider){t.next=5;break}throw f.Ty.notReady("Torus wallet is not initialized");case 5:return this.status=f.MP.CONNECTING,this.emit(f.n2.CONNECTING,{adapter:f.rW.TORUS_SOLANA}),t.prev=7,t.next=10,this.torusInstance.login(this.loginSettings);case 10:return t.prev=10,(e=this.torusInstance.provider).sendTransaction=this.torusInstance.sendTransaction.bind(this.torusInstance),e.signAllTransactions=this.torusInstance.signAllTransactions.bind(this.torusInstance),e.signMessage=this.torusInstance.signMessage.bind(this.torusInstance),e.signTransaction=this.torusInstance.signTransaction.bind(this.torusInstance),t.next=18,this.solanaProvider.setupProvider(e);case 18:case 27:t.next=30;break;case 20:if(t.prev=20,t.t0=t.catch(10),!(t.t0 instanceof f.up&&5010===t.t0.code)){t.next=29;break}return i=this.chainConfig,s=i.chainId,a=i.blockExplorer,o=i.displayName,h=i.rpcTarget,l=i.ticker,p=i.tickerName,d={chainId:s,rpcTarget:h,blockExplorerUrl:a,displayName:o,tickerName:p,ticker:l,logo:""},t.next=27,this.torusInstance.setProvider(d);case 29:throw t.t0;case 30:return this.status=f.MP.CONNECTED,this.torusInstance.showTorusButton(),this.emit(f.MP.CONNECTED,{adapter:f.rW.TORUS_SOLANA,reconnected:this.rehydrated}),t.abrupt("return",this.provider);case 36:throw t.prev=36,t.t1=t.catch(7),this.status=f.MP.READY,this.rehydrated=!1,this.emit(f.n2.ERRORED,t.t1),f.RM.connectionError("Failed to login with torus solana wallet");case 42:case"end":return t.stop()}}),t,this,[[7,36],[10,20]])})));return function(){return t.apply(this,arguments)}}()},{key:"disconnect",value:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(){var e,i=arguments;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:{cleanup:!1},this.torusInstance){t.next=3;break}throw f.Ty.notReady("Torus wallet is not initialized");case 3:return t.next=5,(0,c.Z)((0,u.Z)(n.prototype),"disconnect",this).call(this);case 5:return t.next=7,this.torusInstance.logout();case 7:e.cleanup?(this.status=f.MP.NOT_READY,this.torusInstance=null,this.solanaProvider=null):this.status=f.MP.READY,this.emit(f.n2.DISCONNECTED);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(){var e;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.status===f.MP.CONNECTED){t.next=2;break}throw f.RM.notConnectedError("Not connected with wallet");case 2:if(this.torusInstance){t.next=4;break}throw f.Ty.notReady("Torus wallet is not initialized");case 4:return t.next=6,this.torusInstance.getUserInfo();case 6:return e=t.sent,t.abrupt("return",e);case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setAdapterSettings",value:function(t){this.status!==f.MP.READY&&null!==t&&void 0!==t&&t.sessionTime&&(this.sessionTime=t.sessionTime)}}]),n}(g.v)}}]);